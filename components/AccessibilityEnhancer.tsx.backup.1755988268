<<<<<<< HEAD
import React, { useEffect, useState, useCallback } from 'react';

interface AccessibilityFeatures {
  highContrast: boolean;
  reducedMotion: boolean;
  largeText: boolean;
  screenReader: boolean;
  keyboardNavigation: boolean;
}

interface AccessibilityEnhancerProps {
  enabled?: boolean;
  showControls?: boolean;
  autoEnhance?: boolean;
}

const AccessibilityEnhancer: React.FC<AccessibilityEnhancerProps> = ({
  enabled = true,
  showControls = false,
  autoEnhance = true
}) => {
  const [features, setFeatures] = useState<AccessibilityFeatures>({
    highContrast: false,
    reducedMotion: false,
    largeText: false,
    screenReader: false,
    keyboardNavigation: false
  });
  const [isVisible, setIsVisible] = useState(false);
  const [currentFocus, setCurrentFocus] = useState<HTMLElement | null>(null);

  // Detect accessibility preferences
  const detectAccessibilityPreferences = useCallback(() => {
    if (!enabled) return;

    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const prefersHighContrast = window.matchMedia('(prefers-contrast: high)').matches;
    const prefersLargeText = window.matchMedia('(prefers-reduced-motion: no-preference)').matches;

    setFeatures(prev => ({
      ...prev,
      reducedMotion: prefersReducedMotion,
      highContrast: prefersHighContrast,
      largeText: prefersLargeText
    }));

    // Apply preferences automatically
    if (autoEnhance) {
      if (prefersReducedMotion) {
        document.documentElement.style.setProperty('--animation-duration', '0.01ms');
        document.documentElement.style.setProperty('--transition-duration', '0.01ms');
      }
      
      if (prefersHighContrast) {
        document.documentElement.classList.add('high-contrast');
      }
      
      if (prefersLargeText) {
        document.documentElement.style.fontSize = '18px';
      }
    }
  }, [enabled, autoEnhance]);

  // Monitor focus for keyboard navigation
  const monitorFocus = useCallback(() => {
    if (!enabled) return;

    const handleFocusChange = (event: FocusEvent) => {
      const target = event.target as HTMLElement;
      setCurrentFocus(target);
      
      // Add focus indicator
      if (target && target.classList) {
        target.classList.add('focus-visible');
        setTimeout(() => target.classList.remove('focus-visible'), 2000);
      }
    };

    document.addEventListener('focusin', handleFocusChange);
    return () => document.removeEventListener('focusin', handleFocusChange);
  }, [enabled]);

  // Detect screen reader usage
  const detectScreenReader = useCallback(() => {
    if (!enabled) return;

    // Check for common screen reader indicators
    const isScreenReader = 
      navigator.userAgent.includes('NVDA') ||
      navigator.userAgent.includes('JAWS') ||
      navigator.userAgent.includes('VoiceOver') ||
      navigator.userAgent.includes('TalkBack') ||
      window.speechSynthesis !== undefined;

    setFeatures(prev => ({ ...prev, screenReader: isScreenReader }));
  }, [enabled]);

  // Enhanced keyboard navigation
  const enhanceKeyboardNavigation = useCallback(() => {
    if (!enabled) return;

    const handleKeyDown = (event: KeyboardEvent) => {
      const target = event.target as HTMLElement;
      
      // Skip if target is an input or textarea
      if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {
        return;
      }

      switch (event.key) {
        case 'Tab':
          // Ensure focus is visible
          document.documentElement.classList.add('keyboard-navigation');
          break;
        case 'Escape':
          // Close modals or dropdowns
          const modals = document.querySelectorAll('[role="dialog"], [role="menu"]');
          modals.forEach(modal => {
            if (modal instanceof HTMLElement) {
              modal.style.display = 'none';
            }
          });
          break;
        case 'Enter':
        case ' ':
          // Handle click events for keyboard users
          if (target.tagName === 'BUTTON' || target.getAttribute('role') === 'button') {
            event.preventDefault();
            target.click();
          }
          break;
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [enabled]);

  // Add skip links for better navigation
  const addSkipLinks = useCallback(() => {
    if (!enabled) return;

    const skipLinks = [
      { href: '#main', text: 'Skip to main content' },
      { href: '#navigation', text: 'Skip to navigation' },
      { href: '#footer', text: 'Skip to footer' }
    ];

    const skipLinksContainer = document.createElement('div');
    skipLinksContainer.className = 'skip-links';
    skipLinksContainer.setAttribute('aria-label', 'Skip navigation links');

    skipLinks.forEach(link => {
      const skipLink = document.createElement('a');
      skipLink.href = link.href;
      skipLink.textContent = link.text;
      skipLink.className = 'skip-link';
      skipLinksContainer.appendChild(skipLink);
    });

    // Insert at the beginning of body
    if (document.body) {
      document.body.insertBefore(skipLinksContainer, document.body.firstChild);
    }
  }, [enabled]);

  // Add ARIA labels and roles
  const enhanceARIA = useCallback(() => {
    if (!enabled) return;

    // Add missing ARIA labels to interactive elements
    const interactiveElements = document.querySelectorAll('button, a, input, select, textarea');
    
    interactiveElements.forEach(element => {
      if (element instanceof HTMLElement) {
        // Add role if missing
        if (!element.getAttribute('role')) {
          if (element.tagName === 'BUTTON') {
            element.setAttribute('role', 'button');
          } else if (element.tagName === 'A' && element.getAttribute('href')) {
            element.setAttribute('role', 'link');
          }
        }

        // Add aria-label if no text content
        if (!element.getAttribute('aria-label') && !element.textContent?.trim()) {
          const placeholder = element.getAttribute('placeholder');
          const title = element.getAttribute('title');
          if (placeholder) {
            element.setAttribute('aria-label', placeholder);
          } else if (title) {
            element.setAttribute('aria-label', title);
          }
        }
      }
    });
  }, [enabled]);

  // Initialize accessibility features
  useEffect(() => {
    if (!enabled) return;

    detectAccessibilityPreferences();
    detectScreenReader();
    
    const focusCleanup = monitorFocus();
    const keyboardCleanup = enhanceKeyboardNavigation();
    
    // Add skip links after DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', addSkipLinks);
    } else {
      addSkipLinks();
    }

    // Enhance ARIA after a short delay to ensure all elements are loaded
    const ariaTimer = setTimeout(enhanceARIA, 1000);

    return () => {
      focusCleanup?.();
      keyboardCleanup?.();
      clearTimeout(ariaTimer);
    };
  }, [enabled, detectAccessibilityPreferences, detectScreenReader, monitorFocus, enhanceKeyboardNavigation, addSkipLinks, enhanceARIA]);

  // Show controls in development
  useEffect(() => {
    if (process.env.NODE_ENV === 'development' && showControls) {
      setIsVisible(true);
    }
  }, [showControls]);

  if (!enabled || !isVisible) return null;

  const toggleFeature = (feature: keyof AccessibilityFeatures) => {
    setFeatures(prev => {
      const newFeatures = { ...prev, [feature]: !prev[feature] };
      
      // Apply the feature
      if (feature === 'highContrast') {
        document.documentElement.classList.toggle('high-contrast', newFeatures.highContrast);
      } else if (feature === 'reducedMotion') {
        if (newFeatures.reducedMotion) {
          document.documentElement.style.setProperty('--animation-duration', '0.01ms');
          document.documentElement.style.setProperty('--transition-duration', '0.01ms');
        } else {
          document.documentElement.style.removeProperty('--animation-duration');
          document.documentElement.style.removeProperty('--transition-duration');
        }
      } else if (feature === 'largeText') {
        document.documentElement.style.fontSize = newFeatures.largeText ? '20px' : '16px';
      }
      
      return newFeatures;
    });
  };

  return (
    <div className="fixed top-4 right-4 bg-gray-900/90 backdrop-blur-sm border border-gray-700 rounded-lg p-4 text-white text-sm max-w-sm z-50">
      <div className="flex items-center justify-between mb-3">
        <h3 className="font-semibold text-green-400">Accessibility</h3>
        <button
          onClick={() => setIsVisible(false)}
          className="text-gray-400 hover:text-white transition-colors"
        >
          ×
        </button>
      </div>
      
      <div className="space-y-3">
        <div className="flex items-center justify-between">
          <span>High Contrast</span>
          <button
            onClick={() => toggleFeature('highContrast')}
            className={`px-3 py-1 rounded text-xs font-medium transition-colors ${
              features.highContrast 
                ? 'bg-green-500 text-white' 
                : 'bg-gray-600 text-gray-300 hover:bg-gray-500'
            }`}
          >
            {features.highContrast ? 'ON' : 'OFF'}
          </button>
        </div>
        
        <div className="flex items-center justify-between">
          <span>Reduced Motion</span>
          <button
            onClick={() => toggleFeature('reducedMotion')}
            className={`px-3 py-1 rounded text-xs font-medium transition-colors ${
              features.reducedMotion 
                ? 'bg-green-500 text-white' 
                : 'bg-gray-600 text-gray-300 hover:bg-gray-500'
            }`}
          >
            {features.reducedMotion ? 'ON' : 'OFF'}
          </button>
        </div>
        
        <div className="flex items-center justify-between">
          <span>Large Text</span>
          <button
            onClick={() => toggleFeature('largeText')}
            className={`px-3 py-1 rounded text-xs font-medium transition-colors ${
              features.largeText 
                ? 'bg-green-500 text-white' 
                : 'bg-gray-600 text-gray-300 hover:bg-gray-500'
            }`}
          >
            {features.largeText ? 'ON' : 'OFF'}
          </button>
        </div>
        
        <div className="flex items-center justify-between">
          <span>Screen Reader</span>
          <span className={`px-3 py-1 rounded text-xs font-medium ${
            features.screenReader 
              ? 'bg-blue-500 text-white' 
              : 'bg-gray-600 text-gray-300'
          }`}>
            {features.screenReader ? 'DETECTED' : 'NOT DETECTED'}
          </span>
        </div>
        
        <div className="flex items-center justify-between">
          <span>Keyboard Navigation</span>
          <span className={`px-3 py-1 rounded text-xs font-medium ${
            features.keyboardNavigation 
              ? 'bg-blue-500 text-white' 
              : 'bg-gray-600 text-gray-300'
          }`}>
            {features.keyboardNavigation ? 'ACTIVE' : 'INACTIVE'}
          </span>
        </div>
      </div>

      {currentFocus && (
        <div className="mt-3 pt-3 border-t border-gray-700">
          <div className="text-xs text-gray-400">
            <div>Current Focus:</div>
            <div className="text-white font-mono truncate">
              {currentFocus.tagName.toLowerCase()}
              {currentFocus.id && `#${currentFocus.id}`}
              {currentFocus.className && `.${currentFocus.className.split(' ')[0]}`}
            </div>
          </div>
        </div>
      )}
    </div>
=======
import React, { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { SkipForward, Volume2, VolumeX, Eye, EyeOff, Keyboard, Accessibility } from 'lucide-react';

interface AccessibilityEnhancerProps {
  children: React.ReactNode;
}

const AccessibilityEnhancer: React.FC<AccessibilityEnhancerProps> = ({ children }) => {
  const [isVisible, setIsVisible] = useState(false);
  const [isHighContrast, setIsHighContrast] = useState(false);
  const [isReducedMotion, setIsReducedMotion] = useState(false);
  const [isLargeText, setIsLargeText] = useState(false);
  const [isSpacing, setIsSpacing] = useState(false);
  const [isFocusVisible, setIsFocusVisible] = useState(false);

  useEffect(() => {
    // Check user preferences
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const prefersHighContrast = window.matchMedia('(prefers-contrast: high)').matches;
    
    setIsReducedMotion(prefersReducedMotion);
    setIsHighContrast(prefersHighContrast);

    // Listen for preference changes
    const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    const contrastQuery = window.matchMedia('(prefers-contrast: high)');

    const handleMotionChange = (e: MediaQueryListEvent) => setIsReducedMotion(e.matches);
    const handleContrastChange = (e: MediaQueryListEvent) => setIsHighContrast(e.matches);

    motionQuery.addEventListener('change', handleMotionChange);
    contrastQuery.addEventListener('change', handleContrastChange);

    return () => {
      motionQuery.removeEventListener('change', handleMotionChange);
      contrastQuery.removeEventListener('change', handleContrastChange);
    };
  }, []);

  useEffect(() => {
    // Apply accessibility settings to document
    if (isHighContrast) {
      document.documentElement.classList.add('high-contrast');
    } else {
      document.documentElement.classList.remove('high-contrast');
    }

    if (isReducedMotion) {
      document.documentElement.classList.add('reduced-motion');
    } else {
      document.documentElement.classList.remove('reduced-motion');
    }

    if (isLargeText) {
      document.documentElement.classList.add('large-text');
    } else {
      document.documentElement.classList.remove('large-text');
    }

    if (isSpacing) {
      document.documentElement.classList.add('increased-spacing');
    } else {
      document.documentElement.classList.remove('increased-spacing');
    }

    if (isFocusVisible) {
      document.documentElement.classList.add('focus-visible');
    } else {
      document.documentElement.classList.remove('focus-visible');
    }
  }, [isHighContrast, isReducedMotion, isLargeText, isSpacing, isFocusVisible]);

  const toggleHighContrast = () => setIsHighContrast(!isHighContrast);
  const toggleReducedMotion = () => setIsReducedMotion(!isReducedMotion);
  const toggleLargeText = () => setIsLargeText(!isLargeText);
  const toggleSpacing = () => setIsSpacing(!isSpacing);
  const toggleFocusVisible = () => setIsFocusVisible(!isFocusVisible);

  const handleSkipToContent = () => {
    const mainContent = document.querySelector('main') || document.querySelector('#main-content');
    if (mainContent) {
      mainContent.focus();
      mainContent.scrollIntoView({ behavior: 'smooth' });
    }
  };

  const handleSkipToNavigation = () => {
    const navigation = document.querySelector('nav') || document.querySelector('#navigation');
    if (navigation) {
      navigation.focus();
      navigation.scrollIntoView({ behavior: 'smooth' });
    }
  };

  return (
    <>
      {/* Skip Links */}
      <div className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-[100]">
        <button
          onClick={handleSkipToNavigation}
          className="px-4 py-2 bg-cyan-600 text-white rounded-lg shadow-lg focus-ring-cyan"
        >
          Skip to Navigation
        </button>
        <button
          onClick={handleSkipToContent}
          className="ml-2 px-4 py-2 bg-cyan-600 text-white rounded-lg shadow-lg focus-ring-cyan"
        >
          Skip to Main Content
        </button>
      </div>

      {/* Accessibility Panel */}
      <AnimatePresence>
        {isVisible && (
          <motion.div
            initial={{ opacity: 0, x: 300 }}
            animate={{ opacity: 1, x: 0 }}
            exit={{ opacity: 0, x: 300 }}
            className="fixed top-20 right-4 z-50 w-80 bg-gray-900/95 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl"
          >
            <div className="p-6">
              <div className="flex items-center justify-between mb-6">
                <h3 className="text-lg font-semibold text-white flex items-center">
                  <Accessibility className="w-5 h-5 mr-2 text-cyan-400" />
                  Accessibility
                </h3>
                <button
                  onClick={() => setIsVisible(false)}
                  className="text-gray-400 hover:text-white transition-colors"
                  aria-label="Close accessibility panel"
                >
                  ×
                </button>
              </div>

              <div className="space-y-4">
                {/* High Contrast */}
                <div className="flex items-center justify-between">
                  <label className="text-white text-sm">High Contrast</label>
                  <button
                    onClick={toggleHighContrast}
                    className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
                      isHighContrast ? 'bg-cyan-500' : 'bg-gray-600'
                    }`}
                    aria-label={`${isHighContrast ? 'Disable' : 'Enable'} high contrast`}
                  >
                    <span
                      className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                        isHighContrast ? 'translate-x-6' : 'translate-x-1'
                      }`}
                    />
                  </button>
                </div>

                {/* Reduced Motion */}
                <div className="flex items-center justify-between">
                  <label className="text-white text-sm">Reduced Motion</label>
                  <button
                    onClick={toggleReducedMotion}
                    className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
                      isReducedMotion ? 'bg-cyan-500' : 'bg-gray-600'
                    }`}
                    aria-label={`${isReducedMotion ? 'Disable' : 'Enable'} reduced motion`}
                  >
                    <span
                      className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                        isReducedMotion ? 'translate-x-6' : 'translate-x-1'
                      }`}
                    />
                  </button>
                </div>

                {/* Large Text */}
                <div className="flex items-center justify-between">
                  <label className="text-white text-sm">Large Text</label>
                  <button
                    onClick={toggleLargeText}
                    className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
                      isLargeText ? 'bg-cyan-500' : 'bg-gray-600'
                    }`}
                    aria-label={`${isLargeText ? 'Disable' : 'Enable'} large text`}
                  >
                    <span
                      className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                        isLargeText ? 'translate-x-6' : 'translate-x-1'
                      }`}
                    />
                  </button>
                </div>

                {/* Increased Spacing */}
                <div className="flex items-center justify-between">
                  <label className="text-white text-sm">Increased Spacing</label>
                  <button
                    onClick={toggleSpacing}
                    className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
                      isSpacing ? 'bg-cyan-500' : 'bg-gray-600'
                    }`}
                    aria-label={`${isSpacing ? 'Disable' : 'Enable'} increased spacing`}
                  >
                    <span
                      className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                        isSpacing ? 'translate-x-6' : 'translate-x-1'
                      }`}
                    />
                  </button>
                </div>

                {/* Focus Visible */}
                <div className="flex items-center justify-between">
                  <label className="text-white text-sm">Focus Indicators</label>
                  <button
                    onClick={toggleFocusVisible}
                    className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
                      isFocusVisible ? 'bg-cyan-500' : 'bg-gray-600'
                    }`}
                    aria-label={`${isFocusVisible ? 'Disable' : 'Enable'} focus indicators`}
                  >
                    <span
                      className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                        isFocusVisible ? 'translate-x-6' : 'translate-x-1'
                      }`}
                    />
                  </button>
                </div>
              </div>

              <div className="mt-6 pt-4 border-t border-gray-700">
                <p className="text-xs text-gray-400 text-center">
                  These settings are saved in your browser and will persist across visits.
                </p>
              </div>
            </div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Accessibility Toggle Button */}
      <motion.button
        onClick={() => setIsVisible(!isVisible)}
        className="fixed top-4 right-4 z-40 p-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 focus-ring-cyan"
        whileHover={{ scale: 1.1 }}
        whileTap={{ scale: 0.9 }}
        aria-label="Open accessibility panel"
        aria-expanded={isVisible}
      >
        <Accessibility className="w-5 h-5" />
      </motion.button>

      {/* Render children with accessibility context */}
      <div className={`
        ${isHighContrast ? 'high-contrast' : ''}
        ${isReducedMotion ? 'reduced-motion' : ''}
        ${isLargeText ? 'large-text' : ''}
        ${isSpacing ? 'increased-spacing' : ''}
        ${isFocusVisible ? 'focus-visible' : ''}
      `}>
        {children}
      </div>
    </>
>>>>>>> origin/cursor/analyze-improve-and-deploy-ziontechgroup-app-8af7
  );
};

// Keyboard Navigation Hook
export const useKeyboardNavigation = (items: string[], onSelect: (item: string) => void) => {
  const [selectedIndex, setSelectedIndex] = useState(0);

  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      switch (event.key) {
        case 'ArrowDown':
          event.preventDefault();
          setSelectedIndex(prev => (prev + 1) % items.length);
          break;
        case 'ArrowUp':
          event.preventDefault();
          setSelectedIndex(prev => (prev - 1 + items.length) % items.length);
          break;
        case 'Enter':
        case ' ':
          event.preventDefault();
          onSelect(items[selectedIndex]);
          break;
        case 'Home':
          event.preventDefault();
          setSelectedIndex(0);
          break;
        case 'End':
          event.preventDefault();
          setSelectedIndex(items.length - 1);
          break;
=======
  const setupKeyboardNavigation = useCallback(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (!settings.keyboardNavigation) return;
      
      // Skip to main content
      if (event.key === 'Tab' && event.altKey) {
        event.preventDefault();
        const mainContent = document.querySelector('main') || document.querySelector('#main-content');
        if (mainContent) {
          (mainContent as HTMLElement).focus();
          announceToScreenReader('Skipped to main content');
        }
      }
      
      // Toggle accessibility panel
      if (event.key === 'Escape' && isExpanded) {
        setIsExpanded(false);
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, [settings.keyboardNavigation, isExpanded]);

  const setupFocusIndicators = useCallback(() => {
    const style = document.createElement('style');
    style.textContent = `
      .focus-visible *:focus {
        outline: 3px solid #06b6d4 !important;
        outline-offset: 2px !important;
        border-radius: 4px !important;
      }
      
      .high-contrast {
        --text-primary: #ffffff !important;
        --text-secondary: #e5e7eb !important;
        --bg-primary: #000000 !important;
        --bg-secondary: #1f2937 !important;
        --accent: #ffff00 !important;
      }
      
      .large-text {
        font-size: 1.2em !important;
      }
      
      .large-text h1 { font-size: 2.5em !important; }
      .large-text h2 { font-size: 2em !important; }
      .large-text h3 { font-size: 1.75em !important; }
      .large-text p { font-size: 1.3em !important; }
      
      .reduced-motion * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    `;
    document.head.appendChild(style);
  }, []);

  const announceToScreenReader = useCallback((message: string) => {
    if (!settings.screenReader) return;
    
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', 'polite');
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = message;
    
    document.body.appendChild(announcement);
    
    // Remove after announcement
    setTimeout(() => {
      document.body.removeChild(announcement);
    }, 1000);
    
    // Add to announcements list
    setAnnouncements(prev => [...prev.slice(-4), message]);
  }, [settings.screenReader]);

  const toggleFeature = useCallback((feature: keyof AccessibilitySettings) => {
    const newValue = !settings[feature];
    saveAccessibilitySettings({ [feature]: newValue });
    
    const featureNames = {
      highContrast: 'High contrast',
      largeText: 'Large text',
      reducedMotion: 'Reduced motion',
      screenReader: 'Screen reader',
      keyboardNavigation: 'Keyboard navigation',
      focusIndicator: 'Focus indicators'
    };
    
    announceToScreenReader(
      `${featureNames[feature]} ${newValue ? 'enabled' : 'disabled'}`
    );
  }, [settings, saveAccessibilitySettings, announceToScreenReader]);

  const accessibilityFeatures: AccessibilityFeature[] = [
    {
      id: 'highContrast',
      name: 'High Contrast',
      description: 'Increase contrast for better visibility',
      icon: <Contrast className="w-5 h-5" />,
      enabled: settings.highContrast,
      toggle: () => toggleFeature('highContrast')
    },
    {
      id: 'largeText',
      name: 'Large Text',
      description: 'Increase text size for better readability',
      icon: <Type className="w-5 h-5" />,
      enabled: settings.largeText,
      toggle: () => toggleFeature('largeText')
    },
    {
      id: 'reducedMotion',
      name: 'Reduced Motion',
      description: 'Reduce animations and transitions',
      icon: <Eye className="w-5 h-5" />,
      enabled: settings.reducedMotion,
      toggle: () => toggleFeature('reducedMotion')
    },
    {
      id: 'screenReader',
      name: 'Screen Reader',
      description: 'Enable screen reader announcements',
      icon: <Volume2 className="w-5 h-5" />,
      enabled: settings.screenReader,
      toggle: () => toggleFeature('screenReader')
    },
    {
      id: 'keyboardNavigation',
      name: 'Keyboard Navigation',
      description: 'Enhanced keyboard navigation support',
      icon: <Keyboard className="w-5 h-5" />,
      enabled: settings.keyboardNavigation,
      toggle: () => toggleFeature('keyboardNavigation')
    },
    {
      id: 'focusIndicator',
      name: 'Focus Indicators',
      description: 'Show focus indicators for keyboard users',
      icon: <MousePointer className="w-5 h-5" />,
      enabled: settings.focusIndicator,
      toggle: () => toggleFeature('focusIndicator')
    }
  ];

  return (
    <AnimatePresence>
      {isVisible && (
        <motion.div
          initial={{ opacity: 0, scale: 0.8, y: 20 }}
          animate={{ opacity: 1, scale: 1, y: 0 }}
          exit={{ opacity: 0, scale: 0.8, y: 20 }}
          className="fixed bottom-6 left-6 z-50"
        >
          {/* Accessibility Button */}
          <motion.button
            onClick={() => setIsExpanded(!isExpanded)}
            className="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110"
            whileHover={{ scale: 1.1 }}
            whileTap={{ scale: 0.95 }}
            aria-label="Accessibility settings"
            aria-expanded={isExpanded}
            aria-controls="accessibility-panel"
          >
            <Accessibility className="w-6 h-6" />
          </motion.button>

          {/* Expanded Accessibility Panel */}
          <AnimatePresence>
            {isExpanded && (
              <motion.div
                initial={{ opacity: 0, scale: 0.8, y: 10 }}
                animate={{ opacity: 1, scale: 1, y: 0 }}
                exit={{ opacity: 0, scale: 0.8, y: 10 }}
                className="absolute bottom-16 left-0 w-96 bg-gray-900 border border-gray-700 rounded-xl shadow-2xl overflow-hidden"
                id="accessibility-panel"
                role="dialog"
                aria-labelledby="accessibility-title"
                aria-describedby="accessibility-description"
              >
                {/* Header */}
                <div className="bg-gradient-to-r from-purple-600 to-pink-600 p-4">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center space-x-2">
                      <Accessibility className="w-5 h-5 text-white" />
                      <h3 id="accessibility-title" className="text-white font-semibold">
                        Accessibility Settings
                      </h3>
                    </div>
                    <button
                      onClick={() => setIsExpanded(false)}
                      className="text-white hover:text-gray-200 transition-colors"
                      aria-label="Close accessibility panel"
                    >
                      <X className="w-5 h-5" />
                    </button>
                  </div>
                  <p id="accessibility-description" className="text-sm text-purple-100 mt-1">
                    Customize your experience for better accessibility
                  </p>
                </div>

                {/* Accessibility Features */}
                <div className="p-4 space-y-4 max-h-96 overflow-y-auto">
                  {accessibilityFeatures.map((feature) => (
                    <motion.div
                      key={feature.id}
                      initial={{ opacity: 0, x: -20 }}
                      animate={{ opacity: 1, x: 0 }}
                      className="bg-gray-800 p-3 rounded-lg border border-gray-700 hover:border-purple-500 transition-colors"
                    >
                      <div className="flex items-center justify-between">
                        <div className="flex items-center space-x-3">
                          <div className="text-purple-400">
                            {feature.icon}
                          </div>
                          <div>
                            <div className="text-sm font-medium text-white">
                              {feature.name}
                            </div>
                            <div className="text-xs text-gray-400">
                              {feature.description}
                            </div>
                          </div>
                        </div>
                        <button
                          onClick={feature.toggle}
                          className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 ${
                            feature.enabled ? 'bg-purple-600' : 'bg-gray-600'
                          }`}
                          role="switch"
                          aria-checked={feature.enabled}
                          aria-label={`Toggle ${feature.name}`}
                        >
                          <span
                            className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
                              feature.enabled ? 'translate-x-6' : 'translate-x-1'
                            }`}
                          />
                        </button>
                      </div>
                    </motion.div>
                  ))}

                  {/* Keyboard Shortcuts */}
                  <div className="bg-gray-800 p-3 rounded-lg border border-gray-700">
                    <h4 className="text-sm font-medium text-white mb-2">Keyboard Shortcuts</h4>
                    <div className="space-y-1 text-xs text-gray-400">
                      <div>• <kbd className="px-1 py-0.5 bg-gray-700 rounded text-xs">Alt + Tab</kbd> Skip to main content</div>
                      <div>• <kbd className="px-1 py-0.5 bg-gray-700 rounded text-xs">Escape</kbd> Close panels</div>
                      <div>• <kbd className="px-1 py-0.5 bg-gray-700 rounded text-xs">Tab</kbd> Navigate elements</div>
                    </div>
                  </div>

                  {/* Recent Announcements */}
                  {announcements.length > 0 && (
                    <div className="bg-gray-800 p-3 rounded-lg border border-gray-700">
                      <h4 className="text-sm font-medium text-white mb-2">Recent Updates</h4>
                      <div className="space-y-1">
                        {announcements.map((announcement, index) => (
                          <div key={index} className="text-xs text-gray-400 flex items-center space-x-2">
                            <CheckCircle className="w-3 h-3 text-green-400" />
                            <span>{announcement}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              </motion.div>
            )}
          </AnimatePresence>
        </motion.div>
      )}
    </AnimatePresence>
  );
};

// Focus Trap Hook
export const useFocusTrap = (isActive: boolean) => {
  const containerRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (!isActive) return;

    const container = containerRef.current;
    if (!container) return;

    const focusableElements = container.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );

    const firstElement = focusableElements[0] as HTMLElement;
    const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;

    const handleTabKey = (event: KeyboardEvent) => {
      if (event.key === 'Tab') {
        if (event.shiftKey) {
          if (document.activeElement === firstElement) {
            event.preventDefault();
            lastElement.focus();
          }
        } else {
          if (document.activeElement === lastElement) {
            event.preventDefault();
            firstElement.focus();
          }
        }
      }
    };

    container.addEventListener('keydown', handleTabKey);
    return () => container.removeEventListener('keydown', handleTabKey);
  }, [isActive]);

  return containerRef;
};

// Screen Reader Announcement Hook
export const useScreenReaderAnnouncement = () => {
  const announce = (message: string, priority: 'polite' | 'assertive' = 'polite') => {
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', priority);
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = message;
    
    document.body.appendChild(announcement);
    
    // Remove after announcement
    setTimeout(() => {
      document.body.removeChild(announcement);
    }, 1000);
  };

  return announce;
};

// Skip Link Component
export const SkipLink: React.FC<{ href: string; children: React.ReactNode }> = ({ href, children }) => (
  <a
    href={href}
    className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 z-50 px-4 py-2 bg-cyan-500 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-offset-2"
  >
    {children}
  </a>
);

// Screen Reader Only Text
export const SrOnly: React.FC<{ children: React.ReactNode }> = ({ children }) => (
  <span className="sr-only">{children}</span>
);

// Export the main provider component as default
export default AccessibilityProvider;