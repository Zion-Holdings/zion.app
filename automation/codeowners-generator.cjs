#!/usr/bin/env node
/* eslint-disable */
const fs = require('fs');
const path = require('path');

const ROOT = process.cwd();
const DEFAULT_OWNERS = {
  '/core/': ['@zion-holdings/core-team'],
  '/ai/': ['@zion-holdings/ai-team'],
  '/dao/': ['@zion-holdings/dao-team'],
  '/token/': ['@zion-holdings/token-team'],
  '/academy/': ['@zion-holdings/academy-team'],
  '/governance/': ['@zion-holdings/governance-team'],
  '/deployments/': ['@zion-holdings/devops-team'],
  '/api/': ['@zion-holdings/platform-team'],
};

function renderCodeowners(map) {
  const lines = ['# Auto-generated CODEOWNERS', ''];
  for (const [prefix, owners] of Object.entries(map)) {
    lines.push(`${prefix} ${owners.join(' ')}`);
  }
  lines.push('', '# Generated by automation/codeowners-generator.cjs');
  return lines.join('\n');
}

function main() {
  const content = renderCodeowners(DEFAULT_OWNERS);
  const githubDir = path.join(ROOT, '.github');
  if (!fs.existsSync(githubDir)) fs.mkdirSync(githubDir, { recursive: true });
  const outPath = path.join(githubDir, 'CODEOWNERS');
  fs.writeFileSync(outPath, content);
  console.log('codeowners-generator: wrote .github/CODEOWNERS');
}

if (require.main === module) main();