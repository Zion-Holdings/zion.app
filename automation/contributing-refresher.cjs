const fs = require('fs');
const path = require('path');

(function main() {
  const root = path.resolve(__dirname, '..');
  const file = path.join(root, 'CONTRIBUTING.md');
  const content = [
    '# Contributing to Zion',
    '',
    'Thanks for your interest in contributing! This project is powered by autonomous cloud automations. Please follow the guidelines below.',
    '',
    '## Getting Started',
    '',
    '- Fork and clone the repo',
    '- Use Node 20+ and npm 10+',
    '- Run `npm ci` and `npm run dev` for local development',
    '',
    '## Commit Style',
    '',
    '- Conventional commits (feat, fix, chore, docs, refactor, perf, test)',
    '- Keep changes small and focused',
    '',
    '## Automation Hub',
    '',
    '- Review live agents and reports at `/automation`',
    '- Many changes are auto-generated by Netlify functions',
    '',
    '## Pull Requests',
    '',
    '- Ensure lint passes: `npm run lint`',
    '- Ensure type-check passes: `npm run type-check`',
    '- Provide a clear description and screenshots if UI changes',
    '',
    '## Security',
    '',
    '- Report issues via GitHub Issues',
    '',
    '---',
    '',
    '_This file may be refreshed periodically by an autonomous function._'
  ].join('\n');

  try {
    if (!fs.existsSync(file)) {
      fs.writeFileSync(file, content);
    } else {
      const existing = fs.readFileSync(file, 'utf8');
      if (!existing.includes('# Contributing to Zion')) {
        fs.writeFileSync(file, content);
      }
    }
  } catch {}
})();