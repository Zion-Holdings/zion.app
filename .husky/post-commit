#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "✅ Commit completed successfully!"

# Log commit information
echo "📝 Logging commit details..."
COMMIT_HASH=$(git rev-parse HEAD)
COMMIT_MESSAGE=$(git log -1 --pretty=%B)
COMMIT_DATE=$(date '+%Y-%m-%d %H:%M:%S')

echo "Commit Hash: $COMMIT_HASH"
echo "Commit Message: $COMMIT_MESSAGE"
echo "Commit Date: $COMMIT_DATE"

# Log to automation system if available
if [ -f "automation/universal-automation-launcher.sh" ]; then
    echo "🤖 Updating automation system..."
    echo "{\"commit_hash\": \"$COMMIT_HASH\", \"message\": \"$COMMIT_MESSAGE\", \"date\": \"$COMMIT_DATE\"}" >> automation/logs/commit-history.log 2>/dev/null || true
fi

# Check if this is a deployment commit
if echo "$COMMIT_MESSAGE" | grep -i -E "(deploy|release|production)" > /dev/null; then
    echo "🚀 Deployment commit detected!"
    echo "   Consider running: npm run deploy"
fi

# Show next steps
echo "💡 Next steps:"
echo "   - git push (to push changes)"
echo "   - npm run automation:status (to check automation)"
echo "   - npm run test:all (to run full tests)" 