#!/bin/bash

echo "ğŸ” Running pre-commit checks..."

# Run page structure validation
echo "  ğŸ“‹ Validating page structure..."
npm run build:validate

if [ $? -ne 0 ]; then
  echo "âŒ Page structure validation failed!"
  echo "   Please fix the issues before committing."
  echo "   Run 'npm run build:validate' for details."
  exit 1
fi

# Run quick build health check
echo "  ğŸ¥ Running build health check..."
npm run build:health-check

if [ $? -ne 0 ]; then
  echo "âŒ Build health check failed!"
  echo "   Please fix the build issues before committing."
  echo "   Run 'npm run build:health-check' for details."
  exit 1
fi

# Run linting on staged files only
echo "  ğŸ§¹ Running lint-staged..."
npx lint-staged

if [ $? -ne 0 ]; then
  echo "âŒ Lint-staged failed!"
  echo "   Please fix the issues in staged files."
  exit 1
fi

echo "âœ… All pre-commit checks passed"
echo "   ğŸš€ Ready to commit!"