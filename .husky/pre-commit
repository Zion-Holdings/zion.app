#!/usr/bin/env sh
set -e

echo "üîç Running pre-commit checks..."

# Skip type-check if tsc is not available locally
if [ -x "./node_modules/.bin/tsc" ]; then
  npm run -s type-check || {
    echo "‚ùå TypeScript type check failed. Please fix issues before committing."
    exit 1
  }
else
  echo "‚ÑπÔ∏è  Skipping type-check (tsc not found). Run 'npm install' to enable."
fi

# Check for merge conflicts
bash ./scripts/check-merge-conflicts.sh

# Deletion guard to preserve files unless explicitly allowed
sh ./scripts/prevent-deletion.sh

echo "‚úÖ Pre-commit checks passed"
