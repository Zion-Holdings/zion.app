/* Fonts are now loaded via Next.js font optimization in _app.tsx */
@import './styles/navbar.css';
@import './styles/responsive.css';
@import './styles/auth-layout.css';
@import './styles/performance.css';
@import './styles/responsive-320px.css';

@import './styles/OnsiteForm.css';

/*
  CSS Custom Properties for Theming.
  The primary definitions are now within @layer base.
  The :root definitions here are commented out to avoid conflicts
  as theme colors are intended to be primarily managed by themeUtils.ts
  and fall back to the definitions in @layer base.
*/

/*
:root {
  --background: hsl(0 0% 100%);
  --foreground: hsl(0 0% 3.9%);
  --primary: hsl(221 83% 53%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(14 80% 60%);
  --secondary-foreground: hsl(240 5.9% 10%);
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(0 0% 3.9%);
  --border: hsl(0 0% 89.8%);
  --input: hsl(0 0% 89.8%);
  --ring: hsl(221 83% 53%);
  --accent: hsl(286 63% 55%);
  --accent-foreground: hsl(0 0% 98%);
  --muted: hsl(240 4.8% 95.9%);
  --muted-foreground: hsl(240 3.8% 38%);
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(0 0% 3.9%);
  --destructive: hsl(0 84% 60%);
  --destructive-foreground: hsl(0 0% 98%);
}

:root[data-theme='dark'] {
  --background: hsl(222, 47%, 8%);
  --foreground: hsl(0, 0%, 95%);
  --primary: hsl(221, 100%, 66%);
  --primary-foreground: hsl(222, 47%, 8%);
  --secondary: hsl(14, 92%, 70%);
  --secondary-foreground: hsl(0, 0%, 95%);
  --card: hsl(220, 30%, 11%);
  --card-foreground: hsl(0, 0%, 95%);
  --border: hsl(222, 39%, 17%);
  --input: hsl(222, 39%, 17%);
  --ring: hsl(221, 100%, 66%);
  --accent: hsl(286, 75%, 63%);
  --accent-foreground: hsl(0, 0%, 95%);
  --muted: hsl(220, 30%, 15%);
  --muted-foreground: hsl(0, 0%, 63.9%);
  --popover: hsl(220, 30%, 11%);
  --popover-foreground: hsl(0, 0%, 95%);
  --destructive: hsl(0 62% 30%);
  --destructive-foreground: hsl(0 0% 98%);
}

:root[data-theme='light'] {
  --background: hsl(0 0% 100%);
  --foreground: hsl(0 0% 3.9%);
  --primary: hsl(221 83% 53%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(14 80% 60%);
  --secondary-foreground: hsl(240 5.9% 10%);
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(0 0% 3.9%);
  --border: hsl(0 0% 89.8%);
  --input: hsl(0 0% 89.8%);
  --ring: hsl(221 83% 53%);
  --accent: hsl(286 63% 55%);
  --accent-foreground: hsl(0 0% 98%);
  --muted: hsl(240 4.8% 95.9%);
  --muted-foreground: hsl(240 3.8% 38%);
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(0 0% 3.9%);
  --destructive: hsl(0 84% 60%);
  --destructive-foreground: hsl(0 0% 98%);
}
*/

/*
  The prefers-color-scheme media query is commented out to prevent conflicts
  with the JavaScript-based theme switching (themeUtils.ts), which also handles
  detecting system preference. If a pure CSS fallback for system preference
  is desired when JavaScript is disabled, this can be re-enabled, ensuring
  it defines *all* necessary CSS variables consistently.
*/
/*
@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --background: hsl(222, 47%, 8%);
    --foreground: hsl(0, 0%, 95%);
    --primary: hsl(221, 100%, 66%);
    --primary-foreground: hsl(222, 47%, 8%);
    --secondary: hsl(14, 92%, 70%);
    --secondary-foreground: hsl(0, 0%, 95%);
    --card: hsl(220, 30%, 11%);
    --card-foreground: hsl(0, 0%, 95%);
    --border: hsl(222, 39%, 17%);
    --input: hsl(222, 39%, 17%);
    --ring: hsl(221, 100%, 66%);
    --accent: hsl(286, 75%, 63%);
    --accent-foreground: hsl(0, 0%, 95%);
    --muted: hsl(220, 30%, 15%);
    --muted-foreground: hsl(0, 0%, 63.9%);
    --popover: hsl(220, 30%, 11%);
    --popover-foreground: hsl(0, 0%, 95%);
    --destructive: hsl(0 62% 30%);
    --destructive-foreground: hsl(0 0% 98%);
  }
}
*/

/*Scoped Theme Variables for Mobile App */
.mobile-app {
  min-height: 100vh; /* Ensure it takes full height */
}

.mobile-app[data-theme='light'] {
  --background: hsl(0 0% 100%);
  --foreground: hsl(0 0% 3.9%);
  --primary: hsl(221 83% 53%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(14 80% 60%);
  --secondary-foreground: hsl(240 5.9% 10%);
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(0 0% 3.9%);
  --border: hsl(0 0% 89.8%);
  --input: hsl(0 0% 89.8%);
  --ring: hsl(221 83% 53%);
  --accent: hsl(286 63% 55%);
  --accent-foreground: hsl(0 0% 98%);

  background-color: var(--background);
  color: var(--foreground);
}

.mobile-app[data-theme='dark'] {
  --background: hsl(222, 47%, 8%);
  --foreground: hsl(0, 0%, 95%);
  --primary: hsl(221, 100%, 66%);
  --primary-foreground: hsl(222, 47%, 8%);
  --secondary: hsl(14, 92%, 70%);
  --secondary-foreground: hsl(0, 0%, 95%);
  --card: hsl(220, 30%, 11%);
  --card-foreground: hsl(0, 0%, 95%);
  --border: hsl(222, 39%, 17%);
  --input: hsl(222, 39%, 17%);
  --ring: hsl(221, 100%, 66%);
  --accent: hsl(286, 75%, 63%);
  --accent-foreground: hsl(0, 0%, 95%);

  background-color: var(--background);
  color: var(--foreground);
}

/* Support for Tailwind's dark mode class */
:root.dark {
  --background: hsl(222, 47%, 8%);
  --foreground: hsl(0, 0%, 95%);
  --primary: hsl(221, 100%, 66%);
  --primary-foreground: hsl(222, 47%, 8%);
  --secondary: hsl(14, 92%, 70%);
  --secondary-foreground: hsl(0, 0%, 95%);
  --card: hsl(220, 30%, 11%);
  --card-foreground: hsl(0, 0%, 95%);
  --border: hsl(222, 39%, 17%);
  --input: hsl(222, 39%, 17%);
  --ring: hsl(221, 100%, 66%);
  --accent: hsl(286, 75%, 63%);
  --accent-foreground: hsl(0, 0%, 95%);
  --muted: hsl(220, 30%, 15%);
  --muted-foreground: hsl(0, 0%, 63.9%);
  --popover: hsl(220, 30%, 11%);
  --popover-foreground: hsl(0, 0%, 95%);
  --destructive: hsl(0 62% 30%);
  --destructive-foreground: hsl(0 0% 98%);
}

/* Theme transition animations */
*,
*::before,
*::after {
  transition:
    background-color 0.3s ease,
    color 0.3s ease,
    border-color 0.3s ease,
    box-shadow 0.3s ease;
}

/* Global layout fixes */
html,
body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.container {
  max-width: 1280px;
  margin: 0 auto;
  padding: 1.5rem;
  box-sizing: border-box;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --font-sans: 'Inter', system-ui, sans-serif; /* Matches tailwind.config.js */
    /* font-heading is applied via theme('fontFamily.heading') which uses Orbitron from tailwind.config.js */

    /* Default to zionDefault preset values (light theme) */
    --background: hsl(210 40% 98%);      /* #f8fafc slate-50 */
    --foreground: hsl(222 47% 11%);      /* #0f172a slate-900 */

    --card: hsl(0 0% 100%);              /* #ffffff white */
    --card-foreground: hsl(222 47% 11%); /* #0f172a slate-900 */

    --popover: hsl(0 0% 100%);           /* #ffffff white */
    --popover-foreground: hsl(222 47% 11%);/* #0f172a slate-900 */

    --primary: hsl(224 76% 58%);         /* #2563eb blue-600 */
    --primary-foreground: hsl(0 0% 100%);/* #ffffff white */

    --secondary: hsl(215 20% 91%);       /* #e2e8f0 slate-200 */
    --secondary-foreground: hsl(222 47% 18%);/* #1e293b slate-800 */

    --muted: hsl(215 20% 91%);           /* #e2e8f0 slate-200 */
    --muted-foreground: hsl(215 25% 34%); /* #475569 slate-600 */

    --accent: hsl(224 76% 58%);          /* #2563eb blue-600 */
    --accent-foreground: hsl(0 0% 100%); /* #ffffff white */

    --destructive: hsl(0 72% 51%);       /* #dc2626 red-600 */
    --destructive-foreground: hsl(0 100% 99%);/* #fef2f2 red-50 */

    --border: hsl(215 28% 85%);          /* #cbd5e1 slate-300 */
    --input: hsl(0 0% 100%);             /* #ffffff white (input field background) */
                                         /* border for input will be --border */
    --ring: hsl(var(--modern-primary)); /* Updated ring color */

    --radius: 0.75rem; /* Slightly larger radius for a modern feel */

    /* Sidebar variables - updated for modern theme */
    --sidebar-background: hsl(var(--modern-bg));
    --sidebar-foreground: hsl(var(--modern-text));
    --sidebar-primary: hsl(var(--modern-primary));
    --sidebar-primary-foreground: hsl(var(--modern-text-dark));
    --sidebar-accent: hsl(var(--modern-accent));
    --sidebar-accent-foreground: hsl(var(--modern-text-dark));
    --sidebar-border: hsl(220, 15%, 85%); /* Lighter border for sidebar */
    --sidebar-ring: hsl(var(--modern-primary));
  }

  /* Dark theme fallback for prefers-color-scheme if JS is disabled/fails */
  /* Aligns with the 'dark' preset from themeUtils.ts and modern dark variables */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
      --background: hsl(var(--modern-bg-dark));
      --foreground: hsl(var(--modern-text-dark));
      --card: hsl(220, 25%, 15%); /* Slightly lighter card for dark mode */
      --card-foreground: hsl(var(--modern-text-dark));
      --popover: hsl(var(--modern-bg-dark));
      --popover-foreground: hsl(var(--modern-text-dark));
      --primary: hsl(var(--modern-primary)); /* Already good for dark */
      --primary-foreground: hsl(var(--modern-text-dark));
      --secondary: hsl(var(--modern-secondary)); /* Already good for dark */
      --secondary-foreground: hsl(var(--modern-text-dark));
      --muted: hsl(220, 25%, 20%); /* Muted for dark */
      --muted-foreground: hsl(220, 15%, 70%); /* Muted text for dark */
      --accent: hsl(var(--modern-accent)); /* Already good for dark */
      --accent-foreground: hsl(var(--modern-text-dark));
      --destructive: hsl(0, 70%, 50%); /* Brighter destructive for dark */
      --destructive-foreground: hsl(0, 0%, 100%);
      --border: hsl(220, 25%, 25%); /* Border for dark */
      --input: hsl(220, 25%, 20%);  /* Input bg for dark */
      --ring: hsl(var(--modern-primary));

      /* Dark theme sidebar variables */
      --sidebar-background: hsl(var(--modern-bg-dark));
      --sidebar-foreground: hsl(var(--modern-text-dark));
      --sidebar-primary: hsl(var(--modern-primary));
      --sidebar-primary-foreground: hsl(var(--modern-text-dark));
      --sidebar-accent: hsl(var(--modern-accent));
      --sidebar-accent-foreground: hsl(var(--modern-text-dark));
      --sidebar-border: hsl(220, 25%, 25%);
      --sidebar-ring: hsl(var(--modern-primary));
    }
  }
}

@layer base {
  * {
    border-color: hsl(var(--border)); /* Uses the updated --border variable */
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-family: 'Inter', sans-serif; /* Using Inter as base sans-serif */
    -webkit-font-smoothing: antialiased; /* Smoother fonts on WebKit */
    -moz-osx-font-smoothing: grayscale; /* Smoother fonts on Firefox */
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: 'Orbitron', sans-serif; /* Orbitron for headings */
    letter-spacing: -0.025em; /* Slightly tighter letter spacing for headings */
  }

  h1 {
    @apply text-4xl md:text-5xl font-extrabold text-modern-primary mb-6; /* Using modern primary */
  }

  h2 {
    @apply text-3xl md:text-4xl font-bold text-modern-secondary mb-4; /* Using modern secondary */
  }

  h3 {
    @apply text-2xl font-semibold text-foreground mb-3; /* Standard foreground for h3 for better contrast */
  }

  h4,
  h5,
  h6 {
    @apply font-medium text-muted-foreground mb-2; /* Muted foreground for less emphasis */
  }

  p {
    @apply text-base text-foreground leading-relaxed mb-4;
    line-height: 1.7; /* Increased line-height for readability */
  }

  .content-section {
    @apply my-12 md:my-16 py-8; /* Added padding for better spacing */
    /* Example of a subtle background gradient for sections */
    /* background-image: linear-gradient(to bottom, hsl(var(--modern-bg)), transparent); */
  }

  .card-modern { /* Utility class for cards with modern styling */
    @apply bg-card shadow-modern-md rounded-xl p-6 transition-all duration-300 ease-out hover:shadow-modern-lg;
  }

  .button-modern-primary {
    @apply bg-modern-primary text-white font-semibold py-3 px-6 rounded-lg shadow-modern-sm hover:bg-modern-primary-hover transition-all duration-200 ease-out transform hover:-translate-y-0.5;
  }

  .button-modern-secondary {
    @apply bg-modern-secondary text-white font-semibold py-3 px-6 rounded-lg shadow-modern-sm hover:opacity-90 transition-all duration-200 ease-out transform hover:-translate-y-0.5;
  }

  /* Pulse animation remains useful */
  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* Custom scrollbar for webkit browsers - modernized */
  ::-webkit-scrollbar {
    width: 12px; /* Slightly wider scrollbar */
  }

  ::-webkit-scrollbar-track {
    background: hsl(var(--modern-bg)); /* Modern background for track */
  }

  ::-webkit-scrollbar-thumb {
    background: hsl(var(--modern-primary)); /* Modern primary for thumb */
    border-radius: 6px; /* Rounded thumb */
    border: 3px solid hsl(var(--modern-bg)); /* Creates padding around thumb */
  }

  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--modern-primary-hover)); /* Modern primary hover */
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
    scrollbar-color: hsl(var(--modern-primary)) hsl(var(--modern-bg)); /* For Firefox */
  }

  img {
    max-width: 100%;
    height: auto;
    border-radius: 0.5rem; /* Consistent rounded corners for images */
  }

  /* LiveKit UI overrides - can be updated if LiveKit is themed */
  [data-lk-theme='default'] {
    --lk-color-accent: hsl(var(--modern-primary));
    --lk-button-background: hsl(var(--modern-primary));
    --lk-button-background-hover: hsl(var(--modern-primary-hover));
    --lk-bg1: hsl(var(--modern-bg-dark)); /* Dark background for LiveKit components */
    --lk-bg2: hsl(220, 25%, 15%); /* Slightly lighter dark background */
  }

  /* Skip link styles - enhanced */
  .skip-link {
    position: absolute;
    top: -2.5rem; /* Adjusted position */
    left: 0.5rem;
    background: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
    padding: 0.5rem 1rem;
    z-index: 9999; /* Ensure it's on top */
    transition: top 0.3s ease-in-out;
    border-bottom-right-radius: 0.5rem;
  }

  .skip-link:focus {
    top: 0.5rem; /* Visible position on focus */
  }

  /* Ensure keyboard focus outlines are visible and modern */
  button:focus-visible,
  a:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    outline: 3px solid hsl(var(--ring)); /* Thicker ring */
    outline-offset: 2px;
    box-shadow: 0 0 0 3px hsla(var(--ring), 0.3); /* Softer outer glow */
  }

  /* Input styling enhancements */
  input, textarea, select {
    @apply bg-input border rounded-md px-3 py-2 text-foreground placeholder-muted-foreground;
    border-color: hsl(var(--border));
    @apply focus:ring-2 focus:ring-ring focus:border-transparent focus:outline-none;
    transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }
  input:disabled, textarea:disabled, select:disabled {
    @apply bg-muted opacity-70 cursor-not-allowed;
  }

  /*
  input::placeholder,
  textarea::placeholder {
    color: hsl(var(--muted-foreground));
    opacity: 1;
  }
  */
}

@layer components {
  a {
    @apply transition-colors duration-200 ease-in-out hover:text-modern-primary; /* Use modern primary for hover */
    text-decoration: none; /* Remove underline by default, add on hover if desired */
  }
  a:hover {
    /* text-decoration: underline; */ /* Optional: underline on hover */
  }


  button,
  [role="button"] {
    touch-action: manipulation;
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
    /* Base button styling can be added here if not using utility classes like .button-modern-primary */
  }

  /* Example of a subtle hover effect for interactive elements */
  .interactive-hover {
     @apply transition-all duration-200 ease-out;
  }
  .interactive-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
  }


  @keyframes slide-up { /* Keeping slide-up, it's a common modern effect */
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .animate-slide-up {
    animation: slide-up 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; /* Smoother easing */
  }

  .animate-fade-in { /* Using the fadeIn from tailwind config */
      animation: fadeIn 0.5s ease-out forwards;
  }

  /* Mobile optimizations - adjusted for modern touch targets */
  @media (max-width: 768px) {
    body {
      font-size: 1rem; /* Slightly larger base font for mobile readability */
    }

    button,
    [role='button'],
    input,
    textarea,
    select {
      min-height: 48px; /* Larger touch targets */
      padding: 0.875rem; /* Adjusted padding */
    }

    .container {
      padding-left: 1rem; /* Consistent padding */
      padding-right: 1rem;
    }
    h1 { @apply text-3xl; }
    h2 { @apply text-2xl; }
    h3 { @apply text-xl; }
  }
}

/* Existing specific styles, review if they need to use new modern variables */
.request-btn {
  @apply button-modern-primary; /* Apply modern primary button style */
}
.request-textarea {
  @apply bg-input border rounded-md p-3 text-foreground placeholder-muted-foreground;
  border-color: hsl(var(--border));
  /* color: hsl(var(--foreground)); Already handled by text-foreground */
}
.request-textarea::placeholder {
  /* color: hsl(var(--muted-foreground)); Already handled by placeholder-muted-foreground */
}

@media (max-width: 640px) {
  .search-dropdown {
    max-width: 95vw; /* Slightly more width */
    left: 2.5vw;
    @apply rounded-lg shadow-modern-lg; /* Modern shadow and rounding */
  }
}
