import type { NextApiRequest, NextApiResponse } from 'next';
<<<<<<< HEAD

export function requireAdmin(req: NextApiRequest, res: NextApiResponse): boolean {
  const expected = process.env.ADMIN_TOKEN || 'dev-admin-token';
  const provided = req.headers['x-admin-token'];
  if (!provided || provided !== expected) {
=======
import { getUserFromCookies } from '../auth-utils';

export function requireSuperadminApi(req: NextApiRequest, res: NextApiResponse): boolean {
  const user = getUserFromCookies(req.headers.cookie);
  if (!user || user.role !== 'superadmin' || !user.twofaVerified) {
>>>>>>> origin/cursor/build-zion-ipo-readiness-portal-e565
    res.status(401).json({ error: 'Unauthorized' });
    return false;
  }
  return true;
}