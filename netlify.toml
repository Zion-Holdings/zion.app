[build]
  # Use `npm ci` for deterministic installs
  command = "npm ci && npm run build && npm test -- --coverage && mkdir -p .next/coverage-report && cp -R coverage/lcov-report/* .next/coverage-report/ && npm run test:e2e"
  publish = ".next"

[build.environment]
  NODE_OPTIONS = "--max_old_space_size=4096"
  NPM_FLAGS = "--prefer-offline"
  NODE_VERSION = "20"
  NEXT_PUBLIC_SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY" # Replace with your actual Supabase key
  NEXT_PUBLIC_REOWN_PROJECT_ID = "VALID_PROJECT_ID_PLACEHOLDER" # IMPORTANT: Replace with your actual Reown AppKit Project ID
  EXAMPLE_API_URL = "https://jsonplaceholder.typicode.com/todos/1"
  # Sentry DSN variables must be provided so Netlify Functions can access them
  # Example DSNs so the build doesn't spam warnings when no real DSN is
  # provided. Replace these with your real DSNs in production.
  NEXT_PUBLIC_SENTRY_DSN = "https://examplePublicKey@o0.ingest.sentry.io/0"
  SENTRY_DSN = "https://examplePublicKey@o0.ingest.sentry.io/0"
  # Sentry DSNs are intentionally exposed in client bundles. Exclude them from
  # Netlify's secrets scanning to prevent false positives during deploys.
  SECRETS_SCAN_OMIT_KEYS = "SENTRY_DSN,NEXT_PUBLIC_SENTRY_DSN"
  CYPRESS_TEST_USER_DISPLAY_NAME = "YOUR_CYPRESS_TEST_USER_DISPLAY_NAME"
  CYPRESS_TEST_USER_EMAIL = "YOUR_CYPRESS_TEST_USER_EMAIL"
  CYPRESS_TEST_USER_PASSWORD = "YOUR_CYPRESS_TEST_USER_PASSWORD"
  CYPRESS_EXISTING_USER_EMAIL = "YOUR_CYPRESS_EXISTING_USER_EMAIL"
  CYPRESS_EXISTING_USER_PASSWORD = "YOUR_CYPRESS_EXISTING_USER_PASSWORD"
  CYPRESS_TEST_USER_NAME = "YOUR_CYPRESS_TEST_USER_NAME"
  CYPRESS_STRIPE_TEST_CARD = "YOUR_CYPRESS_STRIPE_TEST_CARD"

[functions.environment]
  SENTRY_LOG_LEVEL = "debug"

[functions.sentryDsnCheckCron]
  schedule = "@daily"
